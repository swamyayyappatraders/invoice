<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="invoice-container">

    <!-- HEADER -->
    <div class="header">
        <img src="logo.png" class="logo">
        <h2 class="title">SRI SWAMY AYYAPPA TRADERS</h2>
        <p class="address">
            Mahatma Gandhi Wholesale Commercial Complex<br>
            Shop No 397, Gollapudi, Vijayawada ‚Äì 521225<br>
            <b>GSTIN:</b> 37AUTPV5283H1ZO
        </p>
    </div>

    <!-- INFO ROW -->
    <table class="info-table">
        <tr>
            <td><b>Invoice No:</b> <span id="invoiceID"></span></td>
            <td><b>Date:</b> <span id="invoiceDate"></span></td>
        </tr>
        <tr>
            <td><b>Customer Name:</b> <span id="customerName"></span></td>
            <td><b>Phone:</b> <span id="customerPhone"></span></td>
        </tr>
    </table>

    <!-- ITEMS TABLE -->
    <table class="items-table">
        <thead>
            <tr>
                <th>Description</th>
                <th>Qty (KG)</th>
                <th>Rate</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody id="itemRows">
        </tbody>
    </table>

    <!-- TOTALS -->
    <div class="totals">
        <p><b>Total Amount:</b> ‚Çπ<span id="totalAmount"></span></p>
        <p><b>Paid Amount:</b> ‚Çπ<span id="paidAmount"></span></p>
        <p><b>Balance:</b> ‚Çπ<span id="balance"></span></p>
        <p><b>Amount in words:</b> <span id="amountWords"></span></p>
    </div>

    <!-- NOTES -->
    <div class="notes">
        <b>Notes:</b>
        <p id="notes"></p>
    </div>

    <!-- SIGNATURE -->
    <div class="signature-box">
        <div class="sig-label">Authorised Signature</div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
        Thank you for your business! üôè<br>
        <small>This is a computer-generated invoice.</small>
    </div>

</div>

<script>
// Read URL parameters
const p = new URLSearchParams(window.location.search);

// Multi-item support (items passed as CSV)
let products = (p.get("product") || "").split(",");
let qtys     = (p.get("qty") || "").split(",");
let rates    = (p.get("rate") || "").split(",");
let amounts  = (p.get("amount") || "").split(",");

let tbody = document.getElementById("itemRows");
for (let i = 0; i < products.length; i++) {
    if (!products[i]) continue;
    let row = `
        <tr>
            <td>${products[i]}</td>
            <td>${qtys[i]}</td>
            <td>‚Çπ${rates[i]}</td>
            <td>‚Çπ${amounts[i]}</td>
        </tr>`;
    tbody.innerHTML += row;
}

// Fill single fields
document.getElementById("invoiceID").innerText = p.get("invoiceID") || "";
document.getElementById("invoiceDate").innerText = p.get("invoiceDate") || "";
document.getElementById("customerName").innerText = p.get("customerName") || "";
document.getElementById("customerPhone").innerText = p.get("customerPhone") || "";
document.getElementById("totalAmount").innerText = p.get("totalAmount") || "";
document.getElementById("paidAmount").innerText = p.get("paidAmount") || "";
document.getElementById("balance").innerText = p.get("balance") || "";
document.getElementById("notes").innerText = p.get("notes") || "";

// Convert number to words
function numberToWords(num) {
    const a = ["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
    "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
    const b = ["","", "Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];

    if ((num = num.toString()).length > 9) return "Overflow";
    let n = ('000000000' + num).substr(-9).match(/(\d{2})(\d{2})(\d{2})(\d{3})/);
    if (!n) return "";

    let str = "";
    str += (n[1] != 0) ? (a[Number(n[1])] || b[n[1][0]] + " " + a[n[1][1]]) + " Crore " : "";
    str += (n[2] != 0) ? (a[Number(n[2])] || b[n[2][0]] + " " + a[n[2][1]]) + " Lakh " : "";
    str += (n[3] != 0) ? (a[Number(n[3])] || b[n[3][0]] + " " + a[n[3][1]]) + " Thousand " : "";
    str += (n[4] != 0) ? (a[Number(n[4])] || b[n[4][0]] + " " + a[n[4][1]]) : "";
    return str + " Only";
}

// Fill amount in words
let total = p.get("totalAmount");
document.getElementById("amountWords").innerText = numberToWords(total);
</script>

</body>
</html>
