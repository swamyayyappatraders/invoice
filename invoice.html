<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Invoice</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="invoice-wrapper">

    <!-- HEADER -->
    <div class="header">
        <img src="logo.png" class="logo">
        <div class="shop-info">
            <h2>SRI SWAMY AYYAPPA TRADERS</h2>
            <p>Mahatma Gandhi Wholesale Commercial Complex<br>
            Shop No 397, Gollapudi, Vijayawada ‚Äì 521225<br>
            <b>GSTIN:</b> 37AUTPV5283H1ZO</p>
        </div>
    </div>

    <hr class="line">

    <!-- TOP DETAILS -->
    <div class="top-details">
        <div>
            <b>Invoice No:</b> <span id="invoiceID"></span><br>
            <b>Customer Name:</b> <span id="customerName"></span>
        </div>
        <div>
            <b>Date:</b> <span id="invoiceDate"></span><br>
            <b>Phone:</b> <span id="customerPhone"></span>
        </div>
    </div>

    <hr class="line">

    <!-- TABLE -->
    <table class="item-table">
        <thead>
            <tr>
                <th>Description</th>
                <th>Qty (KG)</th>
                <th>Rate</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody id="itemsBody">
        </tbody>
    </table>

    <hr class="line">

    <!-- TOTALS -->
    <div class="totals">
        <p><b>Total Amount:</b> ‚Çπ<span id="totalAmount"></span></p>
        <p><b>Paid Amount:</b> ‚Çπ<span id="paidAmount"></span></p>
        <p><b>Balance:</b> ‚Çπ<span id="balance"></span></p>
        <p><b>Amount in words:</b> <i><span id="amountWords"></span></i></p>
    </div>

    <hr class="line">

    <!-- NOTES -->
    <div class="notes-section">
        <b>Notes:</b><br>
        <span id="notes"></span>
    </div>

    <br><br>

    <!-- SIGNATURE -->
    <div class="signature-box">
        <div class="sign-line"></div>
        <div class="sign-text">Authorised Signature</div>
    </div>

    <!-- FOOTER -->
    <p class="thanks">Thank you for your business! üôè</p>
    <p class="footer-note">This is a computer-generated invoice.</p>

</div>

<script>
// Read URL Parameters
const p = new URLSearchParams(window.location.search);

// Basic fields
document.getElementById("invoiceID").innerText = p.get("invoiceID") || "";
document.getElementById("invoiceDate").innerText = p.get("invoiceDate") || "";
document.getElementById("customerName").innerText = p.get("customerName") || "";
document.getElementById("customerPhone").innerText = p.get("customerPhone") || "";
document.getElementById("totalAmount").innerText = p.get("totalAmount") || "0";
document.getElementById("paidAmount").innerText = p.get("paidAmount") || "0";
document.getElementById("balance").innerText = p.get("balance") || "0";
document.getElementById("notes").innerText = p.get("notes") || "None";

// MULTI-ITEM HANDLING
// Format expected: items=GN|100|10000,SP|200|24000
const itemsParam = p.get("items");

if (itemsParam) {
    const rows = itemsParam.split(",");
    let html = "";

    rows.forEach(r => {
        const cols = r.split("|");
        html += `
        <tr>
            <td>${cols[0]}</td>
            <td>${cols[1]}</td>
            <td>‚Çπ${cols[2]}</td>
            <td>‚Çπ${cols[3]}</td>
        </tr>`;
    });

    document.getElementById("itemsBody").innerHTML = html;
}

// AMOUNT IN WORDS
function numberToWords(num) {
    const a = ["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
        "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
    const b = ["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];

    if ((num = num.toString()).length > 9) return "Overflow";

    let n = ("000000000" + num).substr(-9).match(/.{1,2}|.{1,1}/g);
    if (!n) return "";

    let str = "";
    str += (n[0] != 0) ? a[Number(n[0])] + " Crore " : "";
    str += (n[1] != 0) ? a[Number(n[1])] + " Lakh " : "";
    str += (n[2] != 0) ? a[Number(n[2])] + " Thousand " : "";
    str += (n[3] != 0) ? a[Number(n[3])] + " Hundred " : "";
    str += (n[4] != 0) ?
        ((str != "") ? "and " : "") + (n[4] < 20 ? a[Number(n[4])] : b[n[4][0]] + " " + a[n[4][1]]) + " " :
        "";

    return str.trim() + " Only";
}

document.getElementById("amountWords").innerText =
    numberToWords(parseInt(p.get("totalAmount") || "0"));

</script>

</body>
</html>
