<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Invoice</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="invoice-wrapper">

    <!-- HEADER -->
    <div class="header-box">
        <img src="logo.png" class="logo">

        <div class="header-text">
            <h2>SRI SWAMY AYYAPPA TRADERS</h2>
            <p>
                Mahatma Gandhi Wholesale Commercial Complex<br>
                Shop No 397, Gollapudi, Vijayawada ‚Äì 521225<br>
                <b>GSTIN:</b> 37AUTPV5283H1ZO
            </p>
        </div>
    </div>

    <hr>

    <!-- BILLING INFO -->
    <table class="info-table">
        <tr>
            <td><b>Invoice No:</b> <span id="invoiceID"></span></td>
            <td><b>Date:</b> <span id="invoiceDate"></span></td>
        </tr>
        <tr>
            <td><b>Customer Name:</b> <span id="customerName"></span></td>
            <td><b>Phone:</b> <span id="customerPhone"></span></td>
        </tr>
    </table>

    <hr>

    <!-- ITEM TABLE -->
    <table class="item-table">
        <thead>
            <tr>
                <th>Description</th>
                <th>Qty (KG)</th>
                <th>Rate</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody id="itemRows"></tbody>
    </table>

    <!-- TOTALS -->
    <div class="totals-box">
        <p><b>Total Amount:</b> ‚Çπ<span id="totalAmount"></span></p>
        <p><b>Paid Amount:</b> ‚Çπ<span id="paidAmount"></span></p>
        <p><b>Balance:</b> ‚Çπ<span id="balance"></span></p>
        <p><b>Amount in words:</b> <span id="amountWords"></span></p>
    </div>

    <hr>

    <!-- NOTES -->
    <div class="notes-box">
        <b>Notes:</b><br>
        <span id="notes"></span>
    </div>

    <br><br>

    <!-- SIGNATURE -->
    <div class="signature-box">
        <div class="sign-line"></div>
        <div class="sign-text">Authorised Signature</div>
    </div>

    <br>

    <!-- FOOTER -->
    <div class="footer">
        <p>Thank you for your business! üôè</p>
        <small>This is a computer-generated invoice.</small>
    </div>

</div>

<script>
// Fetch URL values
const p = new URLSearchParams(window.location.search);

// Multi-item support (comma-separated)
let products = (p.get("product") || "").split(",");
let qtys = (p.get("qty") || "").split(",");
let rates = (p.get("rate") || "").split(",");
let amounts = (p.get("amount") || "").split(",");

// Fill item rows
let itemBody = document.getElementById("itemRows");
itemBody.innerHTML = "";
for (let i = 0; i < products.length; i++) {
    if (!products[i]) continue;
    itemBody.innerHTML += `
        <tr>
            <td>${products[i]}</td>
            <td>${qtys[i] || ''}</td>
            <td>‚Çπ${rates[i] || ''}</td>
            <td>‚Çπ${amounts[i] || ''}</td>
        </tr>
    `;
}

// Convert amount to words
function numberToWords(num) {
    if (!num || isNaN(num)) return "Zero";

    const a = [
        "", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight",
        "Nine", "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen",
        "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"
    ];
    const b = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty",
               "Seventy", "Eighty", "Ninety"];

    function convert(n) {
        if (n < 20) return a[n];
        if (n < 100) return b[Math.floor(n / 10)] + " " + a[n % 10];
        if (n < 1000)
            return a[Math.floor(n / 100)] + " Hundred " + convert(n % 100);
        if (n < 100000)
            return convert(Math.floor(n / 1000)) + " Thousand " + convert(n % 1000);
        if (n < 10000000)
            return convert(Math.floor(n / 100000)) + " Lakh " + convert(n % 100000);
        return convert(Math.floor(n / 10000000)) + " Crore " + convert(n % 10000000);
    }

    return convert(Math.floor(num)) + " Only";
}

// Fill invoice fields
document.getElementById("invoiceID").innerText = p.get("invoiceID");
document.getElementById("invoiceDate").innerText = p.get("invoiceDate");
document.getElementById("customerName").innerText = p.get("customerName");
document.getElementById("customerPhone").innerText = p.get("customerPhone");
document.getElementById("totalAmount").innerText = p.get("totalAmount");
document.getElementById("paidAmount").innerText = p.get("paidAmount");
document.getElementById("balance").innerText = p.get("balance");
document.getElementById("notes").innerText = p.get("notes");

document.getElementById("amountWords").innerText =
    numberToWords(parseFloat(p.get("totalAmount")));
</script>

</body>
</html>
